docs:
  supported_extensions:  [".md", ".html", ".txt", ".pdf", ".rst"]

general_prompts:
  custom_guidance_precedence: |-
    Instruction precedence: When 'Custom Guidance' conflicts with any default
    instructions or checks below, follow 'Custom Guidance'. If guidance excludes
    certain issue classes, omit them from analysis and do not report them unless
    directly necessary to explain another issue.
  retrieve_context: |-
    You are a senior software engineer and your task is to explain what the following FILE does and what its purpose is.
    Include any data flows, function calls, or dependencies that could impact security.
    Make sure you flag any function input that is externally controlled.
    FILE: {file_path}
  security_review_report: |-
    3. How to Report
        - List all identified security issues in a JSON array.
        - Each element must strictly follow this structure:
          [[REVIEW_SCHEMA_FIELDS]]
        - IMPORTANT: If no identified security issues are found, return: {\"reviews\": []}

plugins:
  c:
    supported_extensions: [".c", ".h", ".cc"]
    splitting: &c_cpp_splitting
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts: &c_cpp_prompts
      security_review_file: |-
        You are a thorough security engineer specializing in C/C++.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
           - Only produce findings that are fully justified by FILE and RELEVANT_CONTEXT. If no real issues exist, return an empty reviews list.
           - If it is empty, ignore it.
      security_review: |-
        You are a thorough security engineer specializing in C/C++.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” but take into account how they interact with the whole file.
           - Only produce findings that are fully justified by FILE_CHANGES, ORIGINAL_FILE, and RELEVANT_CONTEXT. If no real issues exist, return an empty reviews list.
           - If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - Memory safety issues
             - Memory aliasing issues
             - Buffer overflows
             - Unsafe function usage
             - Integer overflows
             - Integer underflows
             - Injection vulnerabilities
             - Concurrency issues
               + Specifically watch for removed wait calls or altered synchronization paths
                 that may lead to race conditions or use-after-free.
             - Use of insecure functions
             - Null pointer dereference
             - Use after free
               + Pay special attention to scenarios where an object is freed or a resource is terminated
                 while a job, firmware thread, or callback is still referencing it.
           - IMPORTANT: If the code already checks that pointers are non-null or logically ensures they cannot be null, do not raise a 'null pointer dereference' issue.
           - Pay extra attention to variables that are externally controlled.
           - Do not report on issues that do not affect security.
      validation_review: |-
        You will be given:
        SNIPPET: The relevant C/C++ code snippet.
        RELEVANT CONTEXT: Additional details or commentary on the snippet.
        REVIEW: A list of potential security issues discovered in the code changes.

        Your task is to:
        1. Carefully examine each item in the REVIEW. Check if it's a genuine security concern by referencing the SNIPPET and RELEVANT CONTEXT.
        2. Remove any issues that are false positives or are already mitigated in the code (e.g., null checks exist, safe boundaries are enforced, etc.).
        3. Keep only the issues that definitely represent real security risks.
        4. If an issue is missing details, add the necessary clarifications or background.
        5. If no real issues remain after validation, respond with an empty array: [].
      snippet_security_summary: |-
        You are a thorough security engineer specializing in C/C++.
        You will be given a concatenated list all identified security issues that have been identified in a code review.
        Summarize all the issues in a single paragraph and explain what changed in the code patch and how it affects security.
      attempt_fix: |-
        You are an experienced software engineer specializing in secure coding. Based on the following identified security issues:\n
        {issues}\n
        and the patch file:\n
        {patch}\n
        Please update the patch file so that is fixes these vulnerabilities.
        Do not include any commentary—only output the patch diff.
  cpp:
    supported_extensions: [".cpp", ".hpp"]
    splitting: *c_cpp_splitting
    prompts: *c_cpp_prompts
  tablegen:
    supported_extensions: [".td"]
    splitting:
      chunk_lines: 60
      chunk_lines_overlap: 10
      max_chars: 4000
    prompts:
      security_review: |-
        1. You are a thorough security engineer specializing in LLVM TableGen (.td) specifications.
        Always tie identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce conclusions that are not supported by the .td contents or provided context.

        You will be given:
        1) FILE_CHANGES — a set of .td changes with lines marked by “+” (added) or “-” (removed).
        2) RELEVANT_CONTEXT — notes about target, subtarget features, expected semantics, and patches.
        3) ORIGINAL_FILE — the original TableGen file (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+” or “-” but taking into account how they interact with the whole file.
        If it is empty, ignore it.
      security_review_file: |-
        1. You are a thorough security engineer specializing in LLVM TableGen (.td) specifications.
        Always tie identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce conclusions that are not supported by the .td contents or provided context.

        You will be given:
        1) FILE — a TableGen file (e.g., instruction/operand/register definitions, patterns, features).
        2) RELEVANT_CONTEXT — notes about target, subtarget features, expected semantics, and patches.

      security_review_checks: |-
        Your tasks:

          - Identify security-relevant mis-specifications in FILE that could alter program semantics or expose unsafe code paths. Focus on:
            * Incorrect codegen or pattern matches that generate unintended instructions.
            * Privileged or system instructions enabled on unsupported subtargets.
            * Missing side-effect or memory flags (e.g., hasSideEffects, mayLoad, mayStore) that allow illegal optimization or reordering.
            * Overly permissive immediates or operand definitions that permit invalid encodings.
            * Pseudo-instruction expansions dropping required barriers, implicit defs/uses, or side effects.
            * Incorrect ImplicitUses or ImplicitDefs that permit register clobbers or privilege transitions.
            * Missing Predicates or Requires clauses that fail to restrict instructions to correct modes or features.
            * Compression or relaxation patterns that unintentionally modify control flow or privilege level.
            * Scheduling or itinerary omissions that skip necessary fences or barriers, compromising temporal safety.

          - Validate correctness of the following TableGen constructs and attributes:
            * Instruction flags: hasSideEffects, mayLoad, mayStore, isBarrier, isPseudo, isCall, isReturn, isBranch, isTrap, isTerminator.
            * Feature gating: Predicates, Requires, and SubtargetFeature usage.
            * Operand and register definitions: RegisterClass, RegisterOperand, OperandWithDefaultOps, and AsmOperandClass.
            * Immediate constraints: ImmLeaf, ComplexPattern, and constant range validation.
            * Pseudo lowering: UsesCustomInserter, ExpandPseudo — verify preservation of side effects and operand semantics.
            * Pattern breadth: Pat<> and Pattern= constructs — flag overly generic operand or type matches.
            * ImplicitUses / ImplicitDefs accuracy — ensure all implicit dependencies are correctly modeled.

          - Perform Security Impact Analysis:
            * For each issue, describe the specific failure mode (e.g., “mayStore=0 on a memory op allows reordering across fences”).
            * Classify severity (HIGH, MEDIUM, LOW, CRITICAL) and identify relevant preconditions (target, subtarget feature, or execution mode).
            * Distinguish between compile-time acceptance issues (assembler/matcher) and runtime miscompiles or privilege violations.

          - Propose Minimal Reproduction Tests (non-executable):
            * Describe 1-2 targeted lit tests (TableGen/MC/CodeGen) that could expose the issue.
            * Include relevant patterns, features, or intrinsics to trigger the vulnerable behavior.

          - Recommend Remediation:
            * Provide specific TableGen fixes (flags, predicates, operand constraints, pseudo-lowering adjustments).
            * Include additional feature gating, implicit defs/uses, or barrier insertion as necessary.
      snippet_security_summary: |-
        Summarize the security implications of these TableGen (.td) changes. Focus on:
        - Mis-specifications that could alter program semantics or expose unsafe paths.
        - Incorrect feature gating or privilege-related instructions becoming available.
        - Missing side effects / memory flags impacting reordering or optimization.
        Keep the summary concise and actionable.
      validation_review: "Validate the following TableGen review for security concerns."
  ipynb:
    supported_extensions: [".ipynb"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Python/Jupyter notebooks.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by "+" indicating what has been added or "-" for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with "+." or "-" but take into account how they interact with the whole file.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - OWASP Top 10 vulnerabilities
             - Hardcoded secrets, urls or endpoints
             - Insecure use of libraries
             - Data exposure in notebook outputs
             - Insecure notebook execution
             - Unnecessary or insecure notebook imports
             - Insecure cells import orders
             - Databricks not followed best practices
             - Logging or printing sensitive informations or hardcoded endpoints
             - Do not report on issues that do not affect security.
      validation_review: "Validate the following Jupyter notebook review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Jupyter notebook code changes."
      attempt_fix: "Based on the issues detected in the Jupyter notebook code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Python/Jupyter notebooks.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
  python:
    supported_extensions: [".py"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Python.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” but take into account how they interact with the whole file.
        If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - OWASP Top 10 vulnerabilities
             - Hardcoded secrets
             - Insecure use of libraries
           - Do not report on issues that do not affect security.
      validation_review: "Validate the following Python review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Python code changes."
      attempt_fix: "Based on the issues detected in the Python code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Python.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  ruby:
    supported_extensions: [".rb"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Ruby.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” but take into account how they interact with the whole file.
        If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - OWASP Top 10 vulnerabilities
             - Hardcoded secrets
             - Insecure use of libraries
           - Do not report on issues that do not affect security.
      validation_review: "Validate the following Ruby review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Ruby code changes."
      attempt_fix: "Based on the issues detected in the Ruby code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Ruby.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  go:
    supported_extensions: [".go"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Go services, CLIs, and libraries.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of Go code changes with lines marked by “+” for additions and “-” for removals.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+” or “-” while reasoning about how they interact with the entire package.
           - Only produce findings that are fully justified by FILE_CHANGES, ORIGINAL_FILE, and RELEVANT_CONTEXT. If no real issues exist, return an empty reviews list.
           - If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - Hardcoded secrets, credentials, or tokens.
             - Untrusted data reaching sinks like `os/exec`, file-system paths, SQL drivers, templates, or shell commands without validation/escaping.
             - Insecure HTTP/TLS defaults (missing authentication, allowing `InsecureSkipVerify`, lack of request/body size limits, or clients/servers without timeouts).
             - Use of `math/rand` for nonces, CSRF tokens, or password reset links instead of `crypto/rand`.
             - Goroutines manipulating shared maps/slices without synchronization, channel misuse that can block forever, or missing `context.Context` cancellation leading to DoS.
             - Resources that are not closed (`resp.Body`, files, sockets) or missing `defer` statements causing leaks.
             - Blind deserialization (`json.Unmarshal`/`yaml.Unmarshal`) into permissive structures without validating untrusted input, or use of `unsafe`/cgo without necessary guards.
           - Prioritize boundaries where external input enters the system and any privilege transitions.
           - Do not report on issues that do not affect security.
      validation_review: "Validate the following Go review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Go code changes."
      attempt_fix: "Based on the issues detected in the Go code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Go.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  typescript:
    supported_extensions: [".ts", ".tsx"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in TypeScript across both Node.js and browser environments.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” but take into account how they interact with the whole file.
        If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - OWASP Top 10 vulnerabilities, especially DOM-XSS, SSRF, CSRF, and broken auth flows.
             - Server-side injection vectors (SQL/NoSQL injections, command injection) in backend TypeScript.
             - Insecure use of `eval`, dynamic `Function`, or unsanitized template literals assigned to DOM sinks like `innerHTML`.
             - Unsanitized data passed into browser APIs (postMessage, storage, cookies) or Node APIs (child_process, file system, HTTP clients).
             - Bypass of TypeScript’s type safety via `any`, `as unknown as`, or unchecked JSON parsing that can hide insecure flows.
             - Hardcoded secrets, credentials, or signing keys.
             - Insecure use of third-party libraries or outdated cryptography.
             - Misconfigured CORS, JWT/session handling, or authentication/authorization guards.
           - Prioritize user-controlled inputs, trust-boundary transitions, and security-sensitive configuration.
           - Do not report on issues that do not affect security.
      validation_review: "Validate the following TypeScript review for security concerns."
      snippet_security_summary: "Summarize the security implications of these TypeScript code changes."
      attempt_fix: "Based on the issues detected in the TypeScript code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in TypeScript across both Node.js and browser environments.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  solidity:
    supported_extensions: [".sol"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Solidity smart contracts and the EVM.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported by the specific
        changes or context provided.

        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” while considering interactions with the whole file.
           - Only produce findings that are fully justified by FILE_CHANGES, ORIGINAL_FILE, and RELEVANT_CONTEXT. If no real issues exist, return an empty reviews list.
           - If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
           - Look for potential security issues such as:
             - Reentrancy vulnerabilities (including external calls before state updates; missing reentrancy guards; pull vs. push payments).
             - Access control flaws (missing/incorrect modifiers; ownership transfer pitfalls; role misconfiguration; private vs public visibility confusion).
             - Use of `tx.origin` for authentication.
             - Unsafe `delegatecall`, `call`, `staticcall`, or `send/transfer` usage; unchecked return values of low-level calls.
             - Integer overflows/underflows or precision loss (especially in arithmetic on token amounts, fees, and interest calculations).
             - Denial-of-service vectors (gas griefing, unbounded loops over dynamic arrays/mappings; state that can be permanently blocked).
             - Front-running / MEV risks and missing commit-reveal or slippage bounds for price-sensitive actions.
             - Insecure randomness (use of `block.timestamp`, `blockhash`, or predictable on-chain data for entropy).
             - Oracle manipulation risks and stale price assumptions.
             - Uninitialized storage pointers or incorrect storage/memory data location causing unintended storage writes.
             - Incorrect visibility or mutability (`public` when `external`/`internal` intended; missing `view`/`pure`; unnecessary `payable`).
             - Missing input validation and invariant checks; unsafe casting; unchecked array indices or length assumptions.
             - Upgradeable/proxy hazards (storage layout collisions, missing `initializer`/`reinitializer`, delegatecall to implementation from constructor).
             - Dangerous `selfdestruct`/`suicide` or ownership renouncement patterns; lost upgrade or recovery paths.
             - ERC20/721/1155 pitfalls (approve/transferFrom front-running, incorrect allowance updates, missing return value checks, missing events).
             - Hardcoded secrets or privileged addresses; reliance on `msg.sender` without proper trust boundaries.
           - Prioritize user-controlled inputs, value transfers, and external call sites.
           - Do not report on issues that do not affect security.
      validation_review: "Validate the following Solidity review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Solidity code changes."
      attempt_fix: "Based on the issues detected in the Solidity code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Solidity smart contracts and the EVM.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  rust:
    supported_extensions: [".rs"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Rust.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce new security conclusions that are not supported
        by the specific changes or context provided.
        You will be given:
        1. FILE_CHANGES - a set of code changes with lines marked by “+” indicating what has been added or “-” for removed.
        2. RELEVANT_CONTEXT - information about what these changes do.
        3. ORIGINAL_FILE - The original file before being modified. Use this to understand how changes affect the code. (this may be empty).

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE_CHANGES, focusing on lines marked with “+.” or “-” but take into account how they interact with the whole file.
        If it is empty, ignore it.
      security_review_checks: |-
        2. What to Check
        - Look for potential security issues such as:
          - Unsafe code usage
            + Pay special attention to any `unsafe` blocks. Ensure they are justified and properly bounded.
            + Check for vulnerabilites relating to raw pointer dereferencing, FFI usage, use-after-free, and manual memory manipulation.
            + Ensure that lifetimes are correctly enforced when using references in unsafe or FFI code.
            + Be alert for transmute or lifetime erasure via raw pointers.
          - Concurrency issues
            + Watch for potential data races in `unsafe` code or improper use of synchronization primitives.
            + Specifically, check for removed `await`/`join` calls or altered locking logic that could introduce race conditions.
          - Integer overflows and underflows
          - Input validation and injection vulnerabilities
            + Look for places where user input is passed to command execution, file paths, or unsafe APIs.
          - Deserialization or parsing issues
            + If the code deserializes external input, ensure it properly validates the format and structure to prevent logic or memory vulnerabilities.
          - Hardcoded secrets
          - Insecure use of libraries
        - IMPORTANT: Rusts ownership model and borrow checker prevent many classes of bugs by design. Do not raise issues that are already statically prevented unless overridden by `unsafe` or FFI.
        - Do not report on issues that do not affect security.
      validation_review: "Validate the following Rust review for security concerns."
      snippet_security_summary: "Summarize the security implications of these Rust code changes."
      attempt_fix: "Based on the issues detected in the Rust code changes, propose a fix patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough security engineer specializing in Rust.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
  terraform:
    supported_extensions: [".tf"]
    splitting:
      chunk_lines: 40
      chunk_lines_overlap: 15
      max_chars: 1500
    prompts:
      security_review: |-
        You are a thorough security engineer specializing in Terraform (HCL) and cloud security.
        Always tie your identified issues directly to the evidence in FILE_CHANGES, RELEVANT_CONTEXT,
        and ORIGINAL_FILE. Do not introduce security conclusions that are not supported by the
        specific changes or context provided. Where possible, cite exact line numbers and resource
        addresses from FILE_CHANGES.

        You will be given:
        1) FILE_CHANGES  – A unified diff of Terraform files (HCL) with lines marked by “+” for
           additions and “-” for removals. This may include modules, variables, providers,
           backend configuration, and environment files. Treat “+” and “-” as the primary scope.
        2) RELEVANT_CONTEXT – Short notes explaining intent, environment (e.g., prod/stage),
           cloud(s) targeted, and any linked modules or policies that inform how changes behave.
        3) ORIGINAL_FILE  – The original configuration before modification. Use this to understand
           how changes alter behavior. (If empty, ignore.)

        Your tasks are:

        1. Security Review Scope
           - Review the security implications of FILE_CHANGES, focusing on “+” (added) and “-”
             (removed) lines, but reason about how these interact with the whole module/stack.
           - Only draw conclusions that are directly evidenced by FILE_CHANGES and/or
             RELEVANT_CONTEXT/ORIGINAL_FILE.
      security_review_checks: |-
        2. What to check
        - Look for potential security issues such as:
          - Hardcoded credentials or secrets.
          - Missing encryption of data in transit or storage.
          - Short log retention periods.
          - Data buckets being made public.
          - Overly wide ranges of IPs or ports defined for permitting access.
          - Disabling security features such as scan-on-push in container storage.
      validation_review: "Validate the follow terraform review for security concerns"
      snippet_security_summary: "Summarize the security implications of the terraform code changes"
      attempt_fix: "Based on the issues detected in the terraform code changes, propose a fix/patch. Issues: {issues} Patch: {patch}"
      security_review_file: |-
        You are a thorough DecSecOps engineer specializing in Terraform.
        Always tie your identified issues directly to the evidence in FILE and RELEVANT_CONTEXT.
        Do not introduce new security conclusions that are not supported by the specific changes or context provided.
        You will be given:
        1. FILE - A source code file
        2. RELEVANT_CONTEXT - information about what these changes do.

        Your tasks are:
        1. Security Review Scope
           - Review the security implications of the FILE.
        If it is empty, ignore it.
